# 长上下文提示技巧

https://docs.claude.com/en/docs/build-with-claude/prompt-engineering/long-context-tips

虽然这些技巧普遍适用于所有 Claude 模型，但您可以在[此处](./13.extended-thinking-tips.md)找到针对扩展思维模型的特定提示技巧。

Claude 的扩展上下文窗口（Claude 3 模型为 200K token）能够处理复杂、数据丰富的任务。本指南将帮助您有效地利用这一强大功能。

## 长上下文提示的基本技巧

* **将长篇数据放在顶部**：将您的长文档和输入（约 20K+ token）放在提示的顶部，位于您的查询、指令和示例之上。这可以显著提高所有 Claude 模型的性能。

  测试表明，将查询放在末尾可以将响应质量提高多达 30%，尤其是在处理复杂的多文档输入时。

* **使用 XML 标签构建文档内容和元数据**：在使用多个文档时，请将每个文档包裹在 `<document>` 标签中，并使用 `<document_content>` 和 `<source>`（以及其他元数据）子标签以保持清晰。

  **多文档结构示例**
  
    ```xml
  <documents>
    <document index="1">
      <source>annual_report_2023.pdf</source>
      <document_content>
        {{ANNUAL_REPORT}}
      </document_content>
    </document>
    <document index="2">
      <source>competitor_analysis_q2.xlsx</source>
      <document_content>
        {{COMPETITOR_ANALYSIS}}
      </document_content>
    </document>
  </documents>
  
  分析年度报告和竞争对手分析。确定战略优势并建议第三季度的重点领域。
    ```
  
* **以引用为基础进行响应**：对于长文档任务，要求 Claude 在执行其任务之前首先引用文档的相关部分。这有助于 Claude 排除文档其余内容的“噪音”。

  **引文提取示例**
  
    ```xml
  您是一名人工智能医生助理。您的任务是帮助医生诊断可能的患者疾病。
  
  <documents>
    <document index="1">
      <source>patient_symptoms.txt</source>
      <document_content>
        {{PATIENT_SYMPTOMS}}
      </document_content>
    </document>
    <document index="2">
      <source>patient_records.txt</source>
      <document_content>
        {{PATIENT_RECORDS}}
      </document_content>
    </document>
    <document index="3">
      <source>patient01_appt_history.txt</source>
      <document_content>
        {{PATIENT01_APPOINTMENT_HISTORY}}
      </document_content>
    </document>
  </documents>
  
  从患者记录和预约历史中找到与诊断患者报告的症状相关的引文。将这些引文放在 <quotes> 标签中。然后，根据这些引文，列出所有有助于医生诊断患者症状的信息。将您的诊断信息放在 <info> 标签中。
    ```
